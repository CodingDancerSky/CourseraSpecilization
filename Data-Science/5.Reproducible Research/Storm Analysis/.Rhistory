data_raw <- read.csv("data/repdata-data-StormData.csv", stringsAsFactors = FALSE)
dim(data_raw)
head(data_raw, n = 2)
data_raw$year <- as.numeric(format(as.Date(data_raw$BGN_DATE, format = "%m/%d/%Y %H:%M:%S"), "%Y"))
names(data_raw)
head(data_raw$BGN_DATE)
head(data_raw$year)
hist(stormData$year, breaks = 50, color = 'BLUE')
hist(data_raw$year, breaks = 50, color = 'BLUE')
hist(data_raw$year, breaks = 50, color = 'Blue')
hist(data_raw$year, breaks = 50)
hist(data_raw$year, breaks = 50)
hist(data_raw$year, breaks = 50, color = 'blue')
hist(data_raw$year, breaks = 50, fill = "red")
?hist
hist(data_raw$year, breaks = 50, col = 'Blue')
hist(data_raw$year, breaks = 20, col = 'Blue')
data_raw <- read.csv("data/repdata-data-StormData.csv", stringsAsFactors = FALSE)
d <- dim(data_raw)
head(data, n = 2)
head(data_raw, n = 2)
data <- data_raw[,c('EVTYPE','FATALITIES','INJURIES', 'PROPDMG', 'PROPDMGEXP', 'CROPDMG', 'CROPDMGEXP')]
getnumeric <- function(EXP, NUM, DMG){
data$NUM = 0
data[data$EXP == "H", ]$NUM = data[data$EXP == "H", ]$DMG * 10^2
data[data$EXP == "K", ]$NUM = data[data$EXP == "K", ]$DMG * 10^3
data[data$EXP == "M", ]$NUM = data[data$EXP == "M", ]$DMG * 10^6
data[data$EXP == "B", ]$NUM = data[data$EXP == "B", ]$DMG * 10^9
}
getnumeric("PROPDMGEXP", "PROPDMGNUM", "PROPDMG")
getnumeric("CROPDMGEXP", "CROPDMGNUM", "CROPDMG")
library(ggplot2)
evaluator <- aggregate(FATALITIES ~ EVTYPE, data = data, sum)
evaluator <- evaluator[order(-evaluator$FATALITIES), ][1:10, ]
evaluator <- evaluator[order(-evaluator$FATALITIES), ][1:10, ]
evaluator$EVTYPE <- factor(evaluator$EVTYPE, levels = evaluator$EVTYPE)
ggplot(evaluator, aes(x = EVTYPE, y = FATALITIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Event Type") + ylab("Fatalities") + ggtitle("Number of fatalities by top 10 Weather Events")
ggplot(evaluator, aes(x = EVTYPE, y = FATALITIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Event Type") + ylab("Fatalities") + ggtitle("Number of fatalities of different evaluator")
ggplot(evaluator,     geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Event Type") + ylab("Fatalities") + ggtitle("Number of fatalities of different evaluator")
ggplot(evaluator, aes(x = EVTYPE, y = FATALITIES))
ggplot(evaluator, aes(x = EVTYPE, y = FATALITIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
heme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Evaluator") + ylab("# of Fatalities") +
ggtitle("Number of fatalities of different evaluator")
ggplot(evaluator, aes(x = EVTYPE, y = FATALITIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Evaluator") + ylab("# of Fatalities") +
ggtitle("Number of fatalities of different evaluator")
injuries <- aggregate(INJURIES ~ EVTYPE, data = data, sum)
injuries <- injuries[order(-injuries$INJURIES), ][1:10, ]
injuries$EVTYPE <- factor(injuries$EVTYPE, levels = injuries$EVTYPE)
ggplot(injuries, aes(x = EVTYPE, y = INJURIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Evaluator") + ylab("# of Injuries") +
ggtitle("Number of injuries of different evaluator")
evaluator <- aggregate(FATALITIES ~ EVTYPE, data = data, sum)
evaluator <- evaluator[order(-evaluator$FATALITIES), ][1:10, ]
evaluator$EVTYPE <- factor(evaluator$EVTYPE, levels = evaluator$EVTYPE)
ggplot(evaluator, aes(x = EVTYPE, y = FATALITIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Evaluator") + ylab("# of Fatalities") +
ggtitle("Number of fatalities of different evaluator")
ggplot(injuries, aes(x = EVTYPE, y = INJURIES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Evaluator") + ylab("# of Injuries") +
ggtitle("Number of injuries of different evaluator")
damages <- aggregate(PROPDMGNUM + CROPDMGNUM ~ EVTYPE,
data = data, sum)
head(data$PROPDMGNUM)
names(data)
data <- data_raw[,c('EVTYPE','FATALITIES','INJURIES', 'PROPDMG', 'PROPDMGEXP', 'CROPDMG', 'CROPDMGEXP')]
damages <- aggregate(PROPDMGNUM + CROPDMGNUM ~ EVTYPE,
data = data, sum)
names(data)
getnumeric <- function(EXP, NUM, DMG){
data$NUM = 0
data[data$EXP == "H", ]$NUM = data[data$EXP == "H", ]$DMG * 10^2
data[data$EXP == "K", ]$NUM = data[data$EXP == "K", ]$DMG * 10^3
data[data$EXP == "M", ]$NUM = data[data$EXP == "M", ]$DMG * 10^6
data[data$EXP == "B", ]$NUM = data[data$EXP == "B", ]$DMG * 10^9
}
getnumeric("PROPDMGEXP", "PROPDMGNUM", "PROPDMG")
getnumeric("CROPDMGEXP", "CROPDMGNUM", "CROPDMG")
names(data)
data_raw <- read.csv("data/repdata-data-StormData.csv", stringsAsFactors = FALSE)
d <- dim(data_raw)
head(data_raw, n = 2)
data <- data_raw[,c('EVTYPE','FATALITIES','INJURIES', 'PROPDMG', 'PROPDMGEXP', 'CROPDMG', 'CROPDMGEXP')]
getnumeric <- function(EXP, NUM, DMG){
data$NUM = 0
data[data$EXP == "H", ]$NUM = data[data$EXP == "H", ]$DMG * 10^2
data[data$EXP == "K", ]$NUM = data[data$EXP == "K", ]$DMG * 10^3
data[data$EXP == "M", ]$NUM = data[data$EXP == "M", ]$DMG * 10^6
data[data$EXP == "B", ]$NUM = data[data$EXP == "B", ]$DMG * 10^9
}
getnumeric("PROPDMGEXP", "PROPDMGNUM", "PROPDMG")
getnumeric("CROPDMGEXP", "CROPDMGNUM", "CROPDMG")
library(ggplot2)
damages <- aggregate(PROPDMGNUM + CROPDMGNUM ~ EVTYPE,
data = data, sum)
getnumeric("PROPDMGEXP", "PROPDMGNUM", "PROPDMG")
data$PROPDMGNUM = 0
data[data$PROPDMGEXP == "H", ]$PROPDMGNUM
= data[data$PROPDMGEXP == "H", ]$PROPDMG * 10^2
data[data$PROPDMGEXP == "K", ]$PROPDMGNUM
= data[data$PROPDMGEXP == "K", ]$PROPDMG * 10^3
data[data$PROPDMGEXP == "M", ]$PROPDMGNUM
= data[data$PROPDMGEXP == "M", ]$PROPDMG * 10^6
data[data$PROPDMGEXP == "B", ]$PROPDMGNUM
= data[data$PROPDMGEXP == "B", ]$PROPDMG * 10^9
data$PROPDMGNUM = 0
data[data$PROPDMGEXP == "H", ]$PROPDMGNUM = data[data$PROPDMGEXP == "H", ]$PROPDMG * 10^2
data[data$PROPDMGEXP == "K", ]$PROPDMGNUM = data[data$PROPDMGEXP == "K", ]$PROPDMG * 10^3
data[data$PROPDMGEXP == "M", ]$PROPDMGNUM = data[data$PROPDMGEXP == "M", ]$PROPDMG * 10^6
data[data$PROPDMGEXP == "B", ]$PROPDMGNUM = data[data$PROPDMGEXP == "B", ]$PROPDMG * 10^9
names(data)
getnumeric <- function(EXP, NUM, DMG){
data$NUM = 0
data[data$EXP == "H", ]$NUM = data[data$EXP == "H", ]$DMG * 10^2
data[data$EXP == "K", ]$NUM = data[data$EXP == "K", ]$DMG * 10^3
data[data$EXP == "M", ]$NUM = data[data$EXP == "M", ]$DMG * 10^6
data[data$EXP == "B", ]$NUM = data[data$EXP == "B", ]$DMG * 10^9
}
getnumeric("CROPDMGEXP", "CROPDMGNUM", "CROPDMG")
names(data)
data$CROPDMGNUM = 0
data[data$CROPDMGEXP == "H", ]$CROPDMGNUM = data[data$CROPDMGEXP == "H", ]$CROPDMG * 10^2
data[data$CROPDMGEXP == "K", ]$CROPDMGNUM = data[data$CROPDMGEXP == "K", ]$CROPDMG * 10^3
data[data$CROPDMGEXP == "M", ]$CROPDMGNUM = data[data$CROPDMGEXP == "M", ]$CROPDMG * 10^6
data[data$CROPDMGEXP == "B", ]$CROPDMGNUM = data[data$CROPDMGEXP == "B", ]$CROPDMG * 10^9
damages <- aggregate(PROPDMGNUM + CROPDMGNUM ~ EVTYPE,
data = data, sum)
names(damages)
names(damages) = c("EVTYPE", "DAMAGES")
names(damages) = c("EVTYPE", "DAMAGES")
damages <- damages[order(-damages$DAMAGES), ][1:10, ]
damages$EVTYPE <- factor(damages$EVTYPE, levels = damages$EVTYPE)
ggplot(damages, aes(x = EVTYPE, y = DAMAGES)) +
geom_bar(stat = "identity", fill = "red", las = 3) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Evaluator") + ylab("Damage Degree") +
ggtitle("Property & Crop Damages of the most Harmful Evaluators")
